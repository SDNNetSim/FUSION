# P5.6 Configuration Extension

**Phase:** 5 - ML Control + Protection
**Sub-phase:** P5.6
**Scope:** Add Policy and Protection Configuration Options

---

## Goals

1. Add [policy] section to configuration schema
2. Add [protection] section for 1+1 settings
3. Add [heuristic] section for policy-specific parameters
4. Integrate with CLI parameter system
5. Update config templates with Phase 5 options

---

## Key Deliverables

| Deliverable | Description |
|-------------|-------------|
| `[policy]` config section | Policy type, model path, device |
| `[protection]` config section | Enabled, disjointness, switchover time |
| `[heuristic]` config section | Alpha, seed, policy-specific params |
| CLI parameter integration | Command-line overrides |
| Updated templates | Default and example configurations |

---

## Constraints

- Must maintain backward compatibility with existing configs
- New sections must be optional (have sensible defaults)
- Must integrate with existing config validation
- CLI parameters must override config file values

---

## Dependencies

| Dependency | From |
|------------|------|
| PolicyFactory | P5.5 |
| ProtectionConfig | P5.4 |
| Heuristic policies | P5.2 |
| Existing config schema | Phase 3 |

---

## Micro-Tasks

| Task ID | Type | Description | Output |
|---------|------|-------------|--------|
| P5.6.a | design | Design [policy] config section | Schema extension |
| P5.6.b | design | Design [protection] config section | Schema extension |
| P5.6.c | design | Design [heuristic] config section | Schema extension |
| P5.6.d | wiring-plan | Implement config extension | Complete implementation |
| P5.6.e | verification-plan | Create verification plan | Test suite |

---

## Exit Criteria

- [ ] [policy] section added to schema
- [ ] [protection] section added to schema
- [ ] [heuristic] section added to schema
- [ ] CLI parameters override config values
- [ ] Config validation includes new sections
- [ ] Templates updated with examples
- [ ] All tests pass

---

## Configuration Preview

```ini
# Phase 5 Configuration Sections

[policy]
type = first_feasible           ; first_feasible, shortest_feasible,
                                ; least_congested, random, load_balanced, ml, rl
model_path =                    ; Path to model for ml/rl policies
device = cpu                    ; cpu, cuda
fallback_type = first_feasible  ; Fallback policy for ML errors

[protection]
enabled = false
disjointness = link             ; link, node
switchover_time_ms = 50
revert_after_repair = false

[heuristic]
load_balance_alpha = 0.5        ; For load_balanced policy
random_seed = 42                ; For random policy
```

---

## Next Sub-Phase

P5.6 is the final sub-phase of Phase 5. After completion, the Phase 5 ML Control + Protection integration is complete.
